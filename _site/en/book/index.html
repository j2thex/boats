<!DOCTYPE html>
<!-- Debug Info:
- page.url: /en/book/
- page.lang: en
-->

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Naustvik Slipp & Båtbyggeri</title>
    <link rel="stylesheet" href="/assets/css/main.css">
    
    <!-- Add FullCalendar -->
<script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.10/index.global.min.js'></script>
<script src='https://cdn.jsdelivr.net/npm/@fullcalendar/google-calendar@6.1.10/index.global.min.js'></script>
<script src='https://cdn.jsdelivr.net/npm/@fullcalendar/core@6.1.10/locales/nb.global.min.js'></script>

<script>
    window.CALENDAR_CONFIG = {
        apiKey: ''
    };
</script> 
    
</head>
<body>
    <header class="site-header">
    <!-- Debug Info -->
    <div style="display: none;">
        <p>Current page.lang: en</p>
        <p>Navigation data: [{&quot;title&quot;=&gt;&quot;Home&quot;, &quot;url&quot;=&gt;&quot;/en/&quot;}, {&quot;title&quot;=&gt;&quot;Facilities&quot;, &quot;url&quot;=&gt;&quot;/en/facilities&quot;}, {&quot;title&quot;=&gt;&quot;Book Now&quot;, &quot;url&quot;=&gt;&quot;/en/book&quot;, &quot;highlight&quot;=&gt;true}]</p>
        <p>All site.data: {&quot;en&quot;=&gt;{&quot;facilities&quot;=&gt;[{&quot;id&quot;=&gt;&quot;outdoor-slip&quot;, &quot;name&quot;=&gt;&quot;Outdoor Slip&quot;, &quot;capacity&quot;=&gt;&quot;Up to 80 feet&quot;, &quot;calendar_id&quot;=&gt;&quot;your-calendar-id-1&quot;, &quot;dimensions&quot;=&gt;[&quot;Length: 24m&quot;, &quot;Width: 6m&quot;, &quot;Depth: 3m&quot;], &quot;features&quot;=&gt;[&quot;High-pressure cleaning equipment&quot;, &quot;Professional hull inspection&quot;, &quot;Anti-fouling application&quot;, &quot;Hull maintenance and repair&quot;, &quot;Modern lifting equipment&quot;]}, {&quot;id&quot;=&gt;&quot;indoor-slip&quot;, &quot;name&quot;=&gt;&quot;Indoor Slip&quot;, &quot;capacity&quot;=&gt;&quot;Up to 60 feet&quot;, &quot;calendar_id&quot;=&gt;&quot;74bd1142537d32c30a950c6e0cd36e7c42062a8b39f17bc19192e355dbc6c868@group.calendar.google.com&quot;, &quot;dimensions&quot;=&gt;[&quot;Length: 18m&quot;, &quot;Width: 5.5m&quot;, &quot;Depth: 2.5m&quot;, &quot;Height: 8.5m&quot;], &quot;features&quot;=&gt;[&quot;Weather-protected workspace&quot;, &quot;Professional hull inspection&quot;, &quot;Anti-fouling application&quot;, &quot;Hull maintenance and repair&quot;, &quot;Climate-controlled environment&quot;]}, {&quot;id&quot;=&gt;&quot;floating-dock&quot;, &quot;name&quot;=&gt;&quot;Floating Boathouse&quot;, &quot;capacity&quot;=&gt;&quot;Up to 60 feet&quot;, &quot;calendar_id&quot;=&gt;&quot;your-calendar-id-3&quot;, &quot;dimensions&quot;=&gt;[&quot;Length: 18m&quot;, &quot;Width: 5.4m&quot;, &quot;Depth: 2.5-5m&quot;, &quot;Height: 4.5m&quot;], &quot;features&quot;=&gt;[&quot;Protected from weather&quot;, &quot;Easy access&quot;, &quot;Flexible depth range&quot;, &quot;Ideal for maintenance work&quot;, &quot;Stable working platform&quot;]}], &quot;navigation&quot;=&gt;[{&quot;title&quot;=&gt;&quot;Home&quot;, &quot;url&quot;=&gt;&quot;/en/&quot;}, {&quot;title&quot;=&gt;&quot;Facilities&quot;, &quot;url&quot;=&gt;&quot;/en/facilities&quot;}, {&quot;title&quot;=&gt;&quot;Book Now&quot;, &quot;url&quot;=&gt;&quot;/en/book&quot;, &quot;highlight&quot;=&gt;true}]}, &quot;no&quot;=&gt;{&quot;facilities&quot;=&gt;[{&quot;id&quot;=&gt;&quot;outdoor-slip&quot;, &quot;name&quot;=&gt;&quot;Uteslipp&quot;, &quot;capacity&quot;=&gt;&quot;Opptil 80 fot&quot;, &quot;calendar_id&quot;=&gt;&quot;your-calendar-id-1&quot;, &quot;dimensions&quot;=&gt;[&quot;Lengde: 24m&quot;, &quot;Bredde: 6m&quot;, &quot;Dybde: 3m&quot;], &quot;features&quot;=&gt;[&quot;Høytrykks vaskeutstyr&quot;, &quot;Profesjonell skroginspeksjon&quot;, &quot;Bunnstoff påføring&quot;, &quot;Skrogvedlikehold og reparasjon&quot;, &quot;Moderne løfteutstyr&quot;]}, {&quot;id&quot;=&gt;&quot;indoor-slip&quot;, &quot;name&quot;=&gt;&quot;Inneslipp&quot;, &quot;capacity&quot;=&gt;&quot;Opptil 60 fot&quot;, &quot;calendar_id&quot;=&gt;&quot;74bd1142537d32c30a950c6e0cd36e7c42062a8b39f17bc19192e355dbc6c868@group.calendar.google.com&quot;, &quot;dimensions&quot;=&gt;[&quot;Lengde: 18m&quot;, &quot;Bredde: 5,5m&quot;, &quot;Dybde: 2,5m&quot;, &quot;Høyde: 8,5m&quot;], &quot;features&quot;=&gt;[&quot;Værbeskyttet arbeidsområde&quot;, &quot;Profesjonell skroginspeksjon&quot;, &quot;Bunnstoff påføring&quot;, &quot;Skrogvedlikehold og reparasjon&quot;, &quot;Klimakontrollert miljø&quot;]}, {&quot;id&quot;=&gt;&quot;floating-dock&quot;, &quot;name&quot;=&gt;&quot;Flytenaust&quot;, &quot;capacity&quot;=&gt;&quot;Opptil 60 fot&quot;, &quot;calendar_id&quot;=&gt;&quot;your-calendar-id-3&quot;, &quot;dimensions&quot;=&gt;[&quot;Lengde: 18m&quot;, &quot;Bredde: 5,4m&quot;, &quot;Dybde: 2,5-5m&quot;, &quot;Høyde: 4,5m&quot;], &quot;features&quot;=&gt;[&quot;Beskyttet mot vær&quot;, &quot;Enkel tilgang&quot;, &quot;Fleksibel dybderekkevidde&quot;, &quot;Ideell for vedlikeholdsarbeid&quot;, &quot;Stabil arbeidsplattform&quot;]}], &quot;navigation&quot;=&gt;[{&quot;title&quot;=&gt;&quot;Hjem&quot;, &quot;url&quot;=&gt;&quot;/no/&quot;}, {&quot;title&quot;=&gt;&quot;Anlegg&quot;, &quot;url&quot;=&gt;&quot;/no/facilities&quot;}, {&quot;title&quot;=&gt;&quot;Bestill Nå&quot;, &quot;url&quot;=&gt;&quot;/no/book&quot;, &quot;highlight&quot;=&gt;true}]}}</p>
    </div>

    <div class="header-content">
        <a href="/en/" class="site-title">
            Naustvik Slipp & Båtbyggeri
        </a>
        
        <nav class="main-nav">
            
            <a href="/en/" 
               class="nav-link  ">
                Home
            </a>
            
            <a href="/en/facilities" 
               class="nav-link  ">
                Facilities
            </a>
            
            <a href="/en/book" 
               class="nav-link highlight ">
                Book Now
            </a>
            
        </nav>

        <div class="language-switcher">
            
            <a href="/en/book/" class="active">EN</a>
            <a href="/no/book/" >NO</a>
        </div>
    </div>
</header> 

    <main>
        <div class="booking-container">
    <h1>Book a Facility</h1>
    
    <!-- Facility Selection -->
    <div class="facility-selection">
        <h2>Select a Facility</h2>
        <div class="facility-grid">
            
            
            <div class="facility-card" data-facility-id="outdoor-slip">
                <h3>Outdoor Slip</h3>
                <p class="capacity">Up to 80 feet</p>
                <div class="dimensions">
                    <h4>Dimensions:</h4>
                    <ul>
                        
                        <li>Length: 24m</li>
                        
                        <li>Width: 6m</li>
                        
                        <li>Depth: 3m</li>
                        
                    </ul>
                </div>
                <button class="select-facility" onclick="selectFacility('outdoor-slip', 'your-calendar-id-1')">
                    Select and Check Availability
                </button>
            </div>
            
            <div class="facility-card" data-facility-id="indoor-slip">
                <h3>Indoor Slip</h3>
                <p class="capacity">Up to 60 feet</p>
                <div class="dimensions">
                    <h4>Dimensions:</h4>
                    <ul>
                        
                        <li>Length: 18m</li>
                        
                        <li>Width: 5.5m</li>
                        
                        <li>Depth: 2.5m</li>
                        
                        <li>Height: 8.5m</li>
                        
                    </ul>
                </div>
                <button class="select-facility" onclick="selectFacility('indoor-slip', '74bd1142537d32c30a950c6e0cd36e7c42062a8b39f17bc19192e355dbc6c868@group.calendar.google.com')">
                    Select and Check Availability
                </button>
            </div>
            
            <div class="facility-card" data-facility-id="floating-dock">
                <h3>Floating Boathouse</h3>
                <p class="capacity">Up to 60 feet</p>
                <div class="dimensions">
                    <h4>Dimensions:</h4>
                    <ul>
                        
                        <li>Length: 18m</li>
                        
                        <li>Width: 5.4m</li>
                        
                        <li>Depth: 2.5-5m</li>
                        
                        <li>Height: 4.5m</li>
                        
                    </ul>
                </div>
                <button class="select-facility" onclick="selectFacility('floating-dock', 'your-calendar-id-3')">
                    Select and Check Availability
                </button>
            </div>
            
        </div>
    </div>

    <!-- Calendar and Form Container -->
    <div class="calendar-form-container" style="display: none;" id="calendar-form-container">
        <!-- Calendar View -->
        <div id="calendar-container">
            <h2>Facility Availability</h2>
            <div id="calendar"></div>
        </div>

        <!-- Booking Form -->
        <form id="booking-form" action="https://formspree.io/f/YOUR-FORMSPREE-ID" method="POST">
            <h2>Booking Details</h2>
            <input type="hidden" name="facility" id="facility-input">
            <div class="form-group">
                <label for="date">Date:</label>
                <input type="date" id="date" name="date" required>
            </div>
            <div class="form-group">
                <label for="time">Time:</label>
                <input type="time" id="time" name="time" required>
            </div>
            <div class="form-group">
                <label for="duration">Duration:</label>
                <select id="duration" name="duration" required>
                    <option value="2">2 days (Mon-Wed or Wed-Fri)</option>
                    <option value="4">4 days (Mon-Fri)</option>
                </select>
            </div>
            <div class="form-group">
                <label for="boat-length">Boat Length (meters):</label>
                <input type="number" id="boat-length" name="boat-length" min="1" max="80" step="0.1" required>
            </div>
            <div class="form-group">
                <label for="name">Name:</label>
                <input type="text" id="name" name="name" required>
            </div>
            <div class="form-group">
                <label for="email">Email:</label>
                <input type="email" id="email" name="email" required>
            </div>
            <div class="form-group">
                <label for="phone">Phone:</label>
                <input type="tel" id="phone" name="phone" required>
            </div>
            <button type="submit" id="submit-button">Book Now</button>
            <div id="form-status" style="display: none;"></div>
        </form>
    </div>
</div>

<script>
// Get API key from page front matter
const API_KEY = 'AIzaSyBjijNYbPIcNAaKBbJwgVPg3u3H6nW4ZAA';

function selectFacility(facilityId, calendarId) {
    console.log('Selected calendar ID:', calendarId);
    console.log('API Key:', API_KEY);
    
    // Store facility info
    document.getElementById('facility-input').value = facilityId;
    
    // Show calendar and form container
    const container = document.getElementById('calendar-form-container');
    container.style.display = 'flex';
    
    // Add loading state
    const calendarEl = document.getElementById('calendar');
    calendarEl.innerHTML = '<div class="calendar-loading">Loading calendar...</div>';
    
    // Initialize FullCalendar
    var calendar = new FullCalendar.Calendar(calendarEl, {
        initialView: 'dayGridMonth',
        googleCalendarApiKey: API_KEY,
        eventSources: [{
            googleCalendarId: calendarId,
            className: 'gcal-event',
            failure: function(error) {
                console.error('Error loading events:', error);
                calendarEl.innerHTML = '<div class="calendar-error">Unable to load calendar. Please try again later.</div>';
            }
        }],
        validRange: {
            start: new Date()  // Don't show dates before today
        },
        headerToolbar: {
            left: 'prev,next today',
            center: 'title',
            right: ''  // Remove unnecessary views
        },
        eventDidMount: function(info) {
            console.log('Event mounted:', info.event);
        },
        eventDisplay: 'block',
        displayEventTime: false,
        eventContent: function(arg) {
            return {
                html: '<div class="fc-event-title">Booked</div>'
            };
        },
        dateClick: function(info) {
            const clickedDate = info.date;
            const dayOfWeek = clickedDate.getDay(); // 0 = Sunday, 1 = Monday, ...
            
            // Don't allow selecting past dates
            if (clickedDate < new Date()) {
                return;
            }

            // Only allow selecting Mondays and Wednesdays
            if (dayOfWeek !== 1 && dayOfWeek !== 3) {
                alert('Please select a Monday or Wednesday to start your booking.\n\nMonday bookings can be for 2 days (until Wednesday) or 4 days (until Friday).\nWednesday bookings are for 2 days (until Friday).');
                return;
            }

            // Show booking form
            const bookingForm = document.getElementById('booking-form');
            bookingForm.style.display = 'block';
            
            // Set date and time
            document.getElementById('date').value = info.dateStr;
            document.getElementById('time').value = '09:00';
            
            // Set duration options based on day
            const durationSelect = document.getElementById('duration');
            if (dayOfWeek === 1) { // Monday
                durationSelect.disabled = false;
                durationSelect.value = '2';
            } else { // Wednesday
                durationSelect.value = '2';
                durationSelect.disabled = true; // Only 2 days possible from Wednesday
            }
            
            // Disable time selection - always 9 AM
            document.getElementById('time').disabled = true;
        }
    });
    calendar.render();
}

// Form submission handling
const form = document.getElementById('booking-form');
const formStatus = document.getElementById('form-status');
const submitButton = document.getElementById('submit-button');

form.addEventListener('submit', function(e) {
    e.preventDefault();
    
    // Disable submit button
    submitButton.disabled = true;
    submitButton.textContent = 'Sending...';
    
    // Show loading status
    formStatus.style.display = 'block';
    formStatus.innerHTML = '<div class="calendar-loading">Sending booking request...</div>';
    
    // Get end date based on duration
    const startDate = new Date(document.getElementById('date').value);
    const duration = parseInt(document.getElementById('duration').value);
    const endDate = new Date(startDate);
    endDate.setDate(endDate.getDate() + duration);
    
    // Add end date to form data
    const formData = new FormData(form);
    formData.append('end_date', endDate.toISOString().split('T')[0]);
    
    // Send form data
    fetch(form.action, {
        method: 'POST',
        body: formData,
        headers: {
            'Accept': 'application/json'
        }
    })
    .then(response => response.json())
    .then(data => {
        // Show success message
        formStatus.innerHTML = '<div class="calendar-success">Booking request sent! We will contact you shortly to confirm your booking.</div>';
        form.reset();
        
        // Re-enable submit button
        submitButton.disabled = false;
        submitButton.textContent = 'Book Now';
        
        // Refresh calendar to show new booking
        calendar.refetchEvents();
    })
    .catch(error => {
        // Show error message
        formStatus.innerHTML = '<div class="calendar-error">Sorry, there was a problem sending your booking. Please try again or contact us directly.</div>';
        
        // Re-enable submit button
        submitButton.disabled = false;
        submitButton.textContent = 'Book Now';
    });
});
</script>
    </main>

    <footer>
        <p>© 2024 Naustvik Slipp & Båtbyggeri</p>
    </footer>
</body>
</html>