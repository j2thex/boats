---
layout: default
title: Book a Facility
lang: "en"
ref: book
permalink: /en/book/
---

<div class="booking-container">
    <h1>Book a Facility</h1>
    
    <!-- Facility Selection -->
    <div class="facility-selection">
        <h2>Select a Facility</h2>
        <div class="facility-grid">
            {% assign facilities = site.data['en'].facilities %}
            {% for facility in facilities %}
            <div class="facility-card" data-facility-id="{{ facility.id }}">
                <h3>{{ facility.name }}</h3>
                <p class="capacity">{{ facility.capacity }}</p>
                <div class="dimensions">
                    <h4>Dimensions:</h4>
                    <ul>
                        {% for dimension in facility.dimensions %}
                        <li>{{ dimension }}</li>
                        {% endfor %}
                    </ul>
                </div>
                <button class="select-facility" onclick="selectFacility('{{ facility.id }}', '{{ facility.calendar_id }}')">
                    Select and Check Availability
                </button>
            </div>
            {% endfor %}
        </div>
    </div>

    <!-- Calendar View -->
    <div id="calendar-container" style="display: none;">
        <h2>Facility Availability</h2>
        <div id="calendar"></div>
    </div>

    <!-- Booking Form (initially hidden) -->
    <form id="booking-form" style="display: none;">
        <h2>Booking Details</h2>
        <div class="form-group">
            <label for="date">Date:</label>
            <input type="date" id="date" name="date" required>
        </div>
        <div class="form-group">
            <label for="time">Time:</label>
            <input type="time" id="time" name="time" required>
        </div>
        <div class="form-group">
            <label for="duration">Duration:</label>
            <select id="duration" name="duration" required>
                <option value="2">2 days (standard)</option>
                <option value="3">3 days</option>
                <option value="4">4 days</option>
                <option value="5">5 days</option>
            </select>
        </div>
        <div class="form-group">
            <label for="boat-length">Boat Length (meters):</label>
            <input type="number" id="boat-length" name="boat-length" required>
        </div>
        <div class="form-group">
            <label for="name">Name:</label>
            <input type="text" id="name" name="name" required>
        </div>
        <div class="form-group">
            <label for="email">Email:</label>
            <input type="email" id="email" name="email" required>
        </div>
        <div class="form-group">
            <label for="phone">Phone:</label>
            <input type="tel" id="phone" name="phone" required>
        </div>
        <button type="submit">Book Now</button>
    </form>
</div>

<!-- Add Google Calendar API -->
<script src="https://apis.google.com/js/api.js"></script>

<!-- Add FullCalendar -->
<script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.10/index.global.min.js'></script>

<script>
const API_KEY = '{{ site.google_calendar.api_key }}';

document.addEventListener('DOMContentLoaded', function() {
    // Initialize Google Calendar API
    gapi.load('client', initClient);
});

function initClient() {
    gapi.client.init({
        apiKey: API_KEY,
        discoveryDocs: ['https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest']
    }).then(function() {
        console.log('Google Calendar API initialized');
    }).catch(function(error) {
        console.error('Error initializing Google Calendar API:', error);
    });
}

function selectFacility(facilityId, calendarId) {
    // Show calendar
    const calendarContainer = document.getElementById('calendar-container');
    calendarContainer.style.display = 'block';
    
    // Add loading state
    const calendarEl = document.getElementById('calendar');
    calendarEl.innerHTML = '<div class="calendar-loading">Loading calendar...</div>';
    
    // Initialize FullCalendar
    var calendar = new FullCalendar.Calendar(calendarEl, {
        initialView: 'dayGridMonth',
        events: {
            googleCalendarId: calendarId,
            className: 'gcal-event'
        },
        dateClick: function(info) {
            // Show booking form when a date is clicked
            document.getElementById('booking-form').style.display = 'block';
            document.getElementById('date').value = info.dateStr;
        }
    });
    calendar.render();
}
</script>